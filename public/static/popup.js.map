{"version":3,"file":"popup.js","mappings":"u6CAIA,SAAeA,I,gGACC,SAAMC,K,cAChBC,OADEA,EAAQC,EAAAC,SACyC,wBAAVF,GAC3CG,QAAQC,IAAI,uBACoBC,SAASC,eAAe,SAClDC,UAAY,6DAElBC,OAAOC,QAAQC,GAAGC,cAAcX,G,WAIpC,SAAeD,I,kGAIC,OAFRa,EAA2BP,SAASC,eAAe,eAAgBO,MACnEC,EAA8BT,SAASC,eAAe,kBAAmBO,MACjE,GAAME,MAHR,+CAGmB,CAC7BC,OAAQ,OACRC,QAAS,CACP,eAAgB,oBAElBC,KAAMC,KAAKC,UAAU,CAAER,MAAOA,EAAOE,SAAUA,EAAUO,iBAAiB,MAEzEC,MAAK,SAAUC,GACd,OAAOA,EAASC,MAClB,IACCF,MAAK,SAACE,GAEL,OADArB,QAAQC,IAAIoB,GACRA,EAAKxB,MACAwB,EAAKxB,MAEL,qBAEX,IACCyB,OAAM,SAACC,GACN,OAAOA,EAAMC,OACf,K,OACF,MAAO,CAAP,EArBc1B,EAAAC,Q,OAnBhBM,OAAOoB,SAAQ,SAACC,GACdxB,SAASC,eAAe,aAAawB,QAAU,WAAM,OA2CvD,SAAyBC,G,gGAErB,O,sBAAA,GAAMA,K,cAAN9B,EAAAC,O,+BAGAC,QAAQuB,MAAMM,G,8BAhDqCC,CAAUnC,EAAV,CACvD,G,ICEoB","sources":["webpack://excel-custom-functions/./src/dialogs/popup.ts","webpack://excel-custom-functions/webpack/startup"],"sourcesContent":["Office.onReady((info) => {\n  document.getElementById(\"ok-button\").onclick = () => tryCatch2(sendStringToParentPage);\n});\n\nasync function sendStringToParentPage() {\n  const token = await login();\n  if (token === undefined || token === null || token === \"Invalid credentials\") {\n    console.log(\"Invalid credentials\");\n    const email = <HTMLInputElement>document.getElementById(\"error\");\n    email.innerHTML = \"Your username or password is incorrect. Please try again.\";\n  } else {\n    Office.context.ui.messageParent(token);\n  }\n}\n\nasync function login(): Promise<string> {\n  const url = \"https://api.correlatefinance.com/users/login\";\n  const email = (<HTMLInputElement>document.getElementById(\"email-input\")).value;\n  const password = (<HTMLInputElement>document.getElementById(\"password-input\")).value;\n  const token = await fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({ email: email, password: password, displayInIframe: true }),\n  })\n    .then(function (response) {\n      return response.json();\n    })\n    .then((json) => {\n      console.log(json);\n      if (json.token) {\n        return json.token;\n      } else {\n        return \"Invalid credentials\";\n      }\n    })\n    .catch((error) => {\n      return error.message;\n    });\n  return token;\n}\n\n/** Default helper for invoking an action and handling errors. */\nasync function tryCatch2(callback) {\n  try {\n    await callback();\n  } catch (error) {\n    // Note: In a production add-in, you'd want to notify the user through your add-in's UI.\n    console.error(error);\n  }\n}\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = {};\n__webpack_modules__[38014]();\n"],"names":["sendStringToParentPage","login","token","_a","sent","console","log","document","getElementById","innerHTML","Office","context","ui","messageParent","email","value","password","fetch","method","headers","body","JSON","stringify","displayInIframe","then","response","json","catch","error","message","onReady","info","onclick","callback","error_1","tryCatch2"],"sourceRoot":""}